<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="./css/new.css" media="all">
    <link rel="stylesheet" type="text/css" href="./css/styleScreen.css" media="all">
    <link rel="stylesheet" type="text/css" href="./css/rbcdScreen.css" media="all">
    <link rel="stylesheet" type="text/css" href="./css/ofdScreen.css" media="all">
    <link rel="stylesheet" type="text/css" href="./css/bootstrap.css" media="all">
    <link rel="icon" type="image/x-icon" href="./images/favicon.ico">
    <!-- JVectorMap -->
    <link rel="stylesheet" media="all" href="./css/jquery-jvectormap.css"/>
    <script src="./js/jquery.js"></script>
    <script src="./js/jquery-jvectormap.js"></script>
    <script src="./js/jquery-mousewheel.js"></script>
    <script src="./js/google-charts.js"></script>
    <script src="./js/rbc-charts2.js"></script>
    <script src="./js/maps2.js"></script>

    <script src="./js/assets/jvectormap.js"></script>
    <script src="./js/assets/abstract-element.js"></script>
    <script src="./js/assets/abstract-canvas-element.js"></script>
    <script src="./js/assets/abstract-shape-element.js"></script>
    <script src="./js/assets/svg-element.js"></script>
    <script src="./js/assets/svg-group-element.js"></script>
    <script src="./js/assets/svg-canvas-element.js"></script>
    <script src="./js/assets/svg-shape-element.js"></script>
    <script src="./js/assets/svg-path-element.js"></script>
    <script src="./js/assets/svg-circle-element.js"></script>
    <script src="./js/assets/svg-image-element.js"></script>
    <script src="./js/assets/svg-text-element.js"></script>
    <script src="./js/assets/vml-element.js"></script>
    <script src="./js/assets/vml-group-element.js"></script>
    <script src="./js/assets/vml-canvas-element.js"></script>
    <script src="./js/assets/vml-shape-element.js"></script>
    <script src="./js/assets/vml-path-element.js"></script>
    <script src="./js/assets/vml-circle-element.js"></script>
    <script src="./js/assets/vml-image-element.js"></script>
    <script src="./js/assets/map-object.js"></script>
    <script src="./js/assets/region.js"></script>
    <script src="./js/assets/marker.js"></script>
    <script src="./js/assets/vector-canvas.js"></script>
    <script src="./js/assets/simple-scale.js"></script>
    <script src="./js/assets/ordinal-scale.js"></script>
    <script src="./js/assets/numeric-scale.js"></script>
    <script src="./js/assets/color-scale.js"></script>
    <script src="./js/assets/legend.js"></script>
    <script src="./js/assets/data-series.js"></script>
    <script src="./js/assets/proj.js"></script>
    <script src="./js/assets/map.js"></script>

    <script src="./js/assets/jquery-jvectormap-continents.js"></script>
    <script src="./js/assets/jquery-jvectormap-africa-mill.js"></script>
    <script src="./js/assets/jquery-jvectormap-asia-mill.js"></script>
    <script src="./js/assets/jquery-jvectormap-europe-mill.js"></script>
    <script src="./js/assets/jquery-jvectormap-north_america-mill.js"></script>
    <script src="./js/assets/jquery-jvectormap-oceania-mill.js"></script>
    <script src="./js/assets/jquery-jvectormap-south_america-mill.js"></script>
    <script src="./js/assets/jquery-jvectormap-world-mill.js"></script>
    <meta charset="UTF-8">
    <title>Distributed Risk Profile</title>
</head>

<body>
<div id="ofd_h">
    <div id="ofd-logo">
        <img src="./images/RBCIS_logo.png" alt="RBC I&amp;TS" id="rbcisLogo">
        Distributed Risk Profile - HEAT MAP
    </div>

</div>

<div class="blank-bg">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <form class="form-inline" style="text-align: left; padding: 5px">
                    <div class="form-group">
                        <label for="fund-selection">Select fund to display :</label>
                        <select id="fund-selection" class="form-control">
                        </select>
                    </div>
                </form>
            </div>

            <div class="col-lg-6">
                <ul class="legend" style="padding: 10px 5px 5px 5px">
                    <li><span class="low" style="background-color:rgb(23,160,94)"></span> Low</li>
                    <li><span class="medium" style="background-color:rgb(255,206,66)"></span> Medium</li>
                    <li><span class="high" style="background-color:rgb(219,72,60)"></span> High</li>
                </ul>
            </div>
        </div>
    </div>
</div>


<div class="container">
    <!-- Region pie charts -->
    <div class="row fancy" >
        <h2 class="bodyTitle bodyTitleCustom">Investor risk distribution</h2>
        <div>
            <table>
                <tr id="donutContainer">
                 </tr>
            </table>
        </div>
    </div>

    <!-- World map and bar charts -->
    <div class="row fancy" >
        <div>
            <div id="maps-container" class="col-md-12">
                <div id="world-map" style="width: auto; height: 500px"></div>
            </div>
        </div>
    </div>
</div>

<div class="container" id="pepsPanel">
    <div class="row fancy" >
		<table style="width: 100%">
			<tr>
				<td style="width:50%">
			    	<div id="legalEntityContainer" onclick="legalEntityClickedHandler(event);">
			    	</div>
				</td>
				<td style="width:50%">
			    	<div id="pepsContainer" onclick="pepsClickedHandler(event);">
			    	</div>
				</td>
			</tr>
		</table>
	</div>
</div>

<div>
    <div id="renderFooterIf">
        <div id="footer_hack">
            <div id="copyright">
                <div>
                    <div>
                        <table class="tableNoBorder">
                            <tbody>
                            <tr>
                                <td>&nbsp;</td>
                            </tr>
                            </tbody>
                        </table>
                        <table class="tableNoBorder" width="100%">
                            <tbody>
                            <tr>
                                <td width="10%"></td>
                                <td align="center" width="25%">
                                    <div>
                                        •
                                        <a id="usageAgreementLink" class="grayblue"
                                           href="https://online.rbcits.com/rdis/ViewUsageAgreement.html">Terms and
                                            conditions</a>
                                    </div>
                                </td>
                                <td width="11%"></td>
                            </tr>
                            <tr>
                                <td>
                                </td>
                                <td align="center">
                                    <div>
                                        Royal Bank of Canada website, © 1995-2017
                                    </div>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    $(setObserver());
    $(loadFundDropdown());
    $(drawWorldMap(selectedFund()));

</script>
<script>
	var currentMouseOverRegion = null;
	var mouseEventTimeout = new Map();
	jQuery("path").click(function(event){
		var elem = event.target;

		var regionCode = extractRegion(elem);
		if (regionCode!=null) {
			if (mapCurrentDetailLevel=='world') {
				// Case : the current map displays the full world
				if (currentMouseOverRegion!=null) {
					currentMouseOverRegion = null;
					regionDetailActionHandlerEvent(regionCode);
				}
			} else {
				// Case : the current map is focusing on a geographical region
				countryDetailActionHandlerEvent(extractCountry(elem));
			}
		}
	});

	jQuery("path").mouseenter(function(event) {
		// Case : the user move the mouse over a new country
		var elem = event.target;
		var regionCode = extractRegion(elem);

		if ((regionCode!=null) && (global.hasRiskDataForRegion(regionCode))) {
			if (mapCurrentDetailLevel=='world') {
				// Case : the current map displays the full world, so no focusing on a geographical region
				if (currentMouseOverRegion != regionCode) {
					// Case : the user changed of geographical region
					// Action : colorize the region pointed by the mouse
					currentMouseOverRegion = regionCode;
					colorizeRegion(currentMouseOverRegion, true);
				} else {
					// Case : the mouse was on a country but moved to another country of the same region
					// Action : cancel the clear colorize action
					var timeoutId = mouseEventTimeout.get(regionCode);
					if (timeoutId) {
						window.clearTimeout(timeoutId);
						mouseEventTimeout.delete(regionCode);
					}
				}
			} else {
				// Case : the current map is focusing on a geographical region
				currentSelectedRegion = regionCode;
				colorizeCountry(extractCountry(elem), regionCode, true);
			}
		}
	});

	jQuery("path").mouseout(function(event){
		// Case : the user move the mouse outside of a country
		if (mapCurrentDetailLevel=='world') {
			// Case : the current map displays the full world, so no focusing on a geographical region
			if (currentMouseOverRegion!=null) {
				var currentSelectedRegionCp = currentMouseOverRegion;
				mouseEventTimeout.set(currentSelectedRegionCp, window.setTimeout(function() {
					if (currentSelectedRegionCp!=currentMouseOverRegion) {
						currentMouseOverRegion = null;
					}
					colorizeRegion(currentSelectedRegionCp, null);
				}, 250));
			}
		} else {
			// Case : the current map is focusing on a geographical region
			var elem = event.target;
			currentMouseOverRegion = null;
			colorizeCountry(extractCountry(elem), extractRegion(elem), false);
		}
	});

	</script>

</body>
</html>